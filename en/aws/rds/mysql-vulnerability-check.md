[![CloudSploit](https://cloudsploit.com/img/logo-new-big-text-100.png "CloudSploit")](https://cloudsploit.com)

# AWS / RDS / RDS MySQL Vulnerability Check

## Quick Info

| | |
|-|-|
| **Plugin Title** | RDS MySQL Vulnerability Check |
| **Cloud** | AWS |
| **Category** | RDS |
| **Description** | Ensures RDS MySQL instances are not vulnerable to specific CVEs. |
| **More Info** | Vulnerabilities in RDS MySQL instances can pose significant risks to the security and integrity of your database environment. By identifying and addressing these vulnerabilities, you can protect your data from unauthorized access, data tampering, or privilege escalation. |
| **AWS Link** | https://aws.amazon.com/security/security-bulletins/mysql-5-5-and-5-6-security-advisory/ |
| **Recommended Action** | Update the MySQL engine version to a more recent, patched version to mitigate the vulnerabilities. |


## Introduction

Outdated MySQL engine versions may be vulnerable to known CVEs, exposing your database to security risks. To mitigate such vulnerabilities, AWS allows you to **upgrade the MySQL engine version** (minor or major, as supported) to a newer, patched version.

Amazon RDS supports both **automatic minor version upgrades** (if enabled) and **manual upgrades** (minor or major) for MySQL.

This guide walks you through upgrading your MySQL RDS instance via the AWS Management Console (GUI) to a more secure version, and verifying that the upgrade is successful.


## Detailed Remediation Steps

### 1. Open the Amazon RDS Console and locate your DB instance  
- Sign in to the AWS Management Console and go to the **Amazon RDS** service.  
- In the left navigation pane, click **Databases**.  
- From the list of DB instances, choose the MySQL instance you wish to upgrade.

### 2. Modify the DB instance to select a newer engine version  
- With the DB instance selected, click **Actions** → **Modify**.  
- In the **DB engine version** dropdown under **DB instance configuration**, choose a newer, supported MySQL engine version from the available upgrade targets.
- Optionally (for major version upgrades), ensure the **allow major version upgrade** (or equivalent) is enabled, if presented.

### 3. Schedule or apply the upgrade  
- After choosing the target engine version, click **Continue**.  
- On the summary screen, choose when to apply the upgrade:
  - **Apply immediately** — triggers the upgrade as soon as possible (causing downtime).  
  - **Apply during the next maintenance window** — defers the change to the maintenance window to reduce impact.
- Review the summary of changes and click **Modify DB instance**.

### 4. Monitor the upgrade process  
- The DB instance status will change to **modifying** or **upgrading**.  
- Wait until the status returns to **available**.  
- If the instance has read replicas, ensure any replicas are upgraded first (or follow replica upgrade steps) to maintain compatibility.


## Verification

1. In the RDS Console under **Databases**, select the upgraded DB instance.  
2. Under the **Configuration** or **Details** section, check that:
   - **Engine version** matches the version you selected (or a later patched version).  
   - The instance is in **Available** status (i.e. upgrade is complete).  
3. Run your detection script again; the instance should no longer be flagged as vulnerable (i.e. it should fall outside the vulnerable version ranges).  
4. Optionally, test application behavior (reads/writes) against the upgraded instance to ensure nothing is broken by the engine change.
